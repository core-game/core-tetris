webpackJsonp([1],[,function(t,i,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var r=e(15),o=n(r),s=e(11),a=n(s);e(4),new o.default({el:"#app",render:function(t){return t(a.default)}})},function(t,i,e){"use strict";var n,r,o,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(e,a){"object"===s(i)&&void 0!==t?a(i):(r=[i],n=a,void 0!==(o="function"==typeof n?n.apply(i,r):n)&&(t.exports=o))})(0,function(t){function i(t,i){void 0===t&&(t={}),void 0===i&&(i={});for(var e in i)t[e]=i[e];return t}function e(t){var i=Object.keys(t);return t[i[Math.floor(Math.random()*i.length)]]}function n(t){var i=t.length,e=t[0].length;if(!i||!e)return t;for(var n=[],r=0;r<e;r++){n.push([]);for(var o=0;o<i;o++)n[r][o]=t[o][r]}return n}function r(t){return t.map(function(t){return t.slice()})}function o(t){return r(t).map(function(t){return t.reverse()})}function s(t){return r(t).reverse()}function a(t,i){void 0===i&&(i=!0);var e=n(t);return i?o(e):s(e)}function h(t,i){return JSON.stringify(t)===JSON.stringify(i)}function c(t,i,e){void 0===e&&(e=0);for(var n=[],r=0;r<t;r++){n.push([]);for(var o=0;o<i;o++)n[r].push(e)}return n}function u(t){var i=t.array,e=t.startRow,n=t.endRow,r=t.startCol,o=t.endCol,s=i.length,a=i[0].length;if(s&&a){e=Math.min(Math.max(0,e),s),r=Math.min(Math.max(0,r),a),n=Math.min(Math.max(0,n),s),o=Math.min(Math.max(0,o),a);for(var h=[],c=0,u=n-e;c<u;c++){h.push([]);for(var l=0,f=o-r;l<f;l++)h[c].push(i[c+e][l+r])}return h}}function l(t,i,e){void 0===i&&(i=0),void 0===e&&(e=0);var n=t.length;return n>i?t.slice():Array(i-n).fill(e).concat(t)}function f(t,i,e){void 0===e&&(e=0);var n=t.length;if(n>i)return t.slice();var r=Array(i-n).fill(e);return t.concat(r)}function p(t,i,e){void 0===i&&(i=0),void 0===e&&(e=0);var n=t.length;if(i>=0)return f(t,n+i,e);var r=-i;return r>n?[]:t.slice(0,n-r)}function d(t,i){var e=t.length,n=i.length,r=e-n,o=t.slice(),s=i.slice();r>0?s=l(s,e):r<0&&(o=l(o,n));for(var a=0,h=o.length;a<h;a++)if(o[a]&&s[a])return!0;return!1}function v(t,i){var e=t.length,n=i.length,r=e-n,o=t.slice(),s=i.slice();r>0?s=l(s,e):r<0&&(o=l(o,n));for(var a=[],h=0,c=o.length;h<c;h++)a[h]=s[h]||o[h];return a}function _(t,i){for(var e=Math.min(t.length,i.length),n=0,r=e;n<r;n++)if(d(t[n],i[n]))return!0;return!1}function m(t,i,e){return void 0===i&&(i=0),void 0===e&&(e=0),t.map(function(t){return p(t,i,e)})}function x(t,i,e){void 0===e&&(e=0),t=r(t);var n=t.length;if(!n)return t;var o=i-n,s=t[0].length;return o<=0||s<=0?t:c(o,s,e).concat(t)}function y(t,i){for(var e=r(t),n=0,o=Math.min(t.length,i.length);n<o;n++)e[n]=v(t[n],i[n]);return e}function g(t){var i=t.block,e=t.startX,n=t.endX,r=t.startY,o=t.endY,s=i.x,a=i.y;return{array:u({array:i.array,startCol:e-s,endCol:n-s,startRow:r-a,endRow:o-a}),x:s,y:a}}function b(t,i){var e=t.x,n=t.y,r=t.array,o=r.length,s=r[0].length,a=e,h=a+s,c=n,u=c+o,l=i.x,f=i.y,p=i.array,d=p.length,v=p[0].length,m=l,x=m+v,y=f,b=y+d;if(h<m||u<y)return!1;if(a>x||c>b)return!1;var k=Math.max(a,m),w=Math.max(c,y),C=Math.min(h,x),M=Math.min(u,b),R=g({block:t,startX:k,endX:C,startY:w,endY:M}),O=g({block:i,startX:k,endX:C,startY:w,endY:M});return _(R.array,O.array)}function k(t,i){var e=t.x,n=t.y,o=t.array,s=o.length,a=o[0].length,h=e,c=h+a,u=n,l=u+s,f=i.x,p=i.y,d=i.array,v=d.length,_=d[0].length,x=f,b=x+_,k=p,w=k+v;if(c<x||l<k)return t;if(h>b||u>w)return t;var C=Math.max(h,x),M=Math.max(u,k),R=Math.min(c,b),O=Math.min(l,w),S=g({block:t,startX:h,endX:c,startY:M,endY:O}),j=g({block:i,startX:C,endX:R,startY:M,endY:O}),X=y(S.array,m(j.array,c-R)),Y=r(o);return Y.splice.apply(Y,[M,O-M].concat(X)),{array:Y,x:h,y:u}}function w(t){return t?j[t].clone():e(j)}var C=function(t){this._options=i({row:20,col:10,x:0,y:0},t),this.x=this._options.x,this.y=this._options.y,this.row=this._options.row,this.col=this._options.col,this.reset()},M={coordinate:{}};M.coordinate.get=function(){return{x:this.x,y:this.y,array:this.matrix}},C.prototype.reset=function(){this.matrix=c(this.row,this.col)},Object.defineProperties(C.prototype,M);var R=function(t){void 0===t&&(t=[]),this._shape=t,this._index=0,this.maxCol=this.maxRow=t.length,this._init()},O={shape:{},index:{},margin:{}};R.prototype.clone=function(){return new R(this._shape)},O.shape.get=function(){return this._shapes[this._index]},O.index.get=function(){return this._index},O.index.set=function(t){this._index=t},O.margin.get=function(){var t=Array(this.maxCol).fill(0).join(""),i=this.shape,e=function(i){var e=0,n=0,r=0;return i.map(function(t){return t.join("")}).forEach(function(i){i===t?n?r++:e++:n++}),{start:e,block:n,end:r}},n=e(i),r=n.start,o=n.block,s=n.end,h=e(a(i));return{top:r,row:o,bottom:s,left:h.start,col:h.block,right:h.end}},R.prototype.rotate=function(t){void 0===t&&(t=!0),t?this._index++:this._index--;var i=this._shapes.length;return this._index<0&&(this._index=i-1),this._index>=i&&(this._index=0),this.shape},R.prototype._init=function(){for(var t=this,i=t._shape,e=[i],n=i;;){if(n=a(n),h(n,i))break;e.push(n)}this._shapes=e},Object.defineProperties(R.prototype,O);var S={I:[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],J:[[0,0,0],[1,1,1],[0,0,1]],L:[[0,0,0],[1,1,1],[1,0,0]],O:[[1,1],[1,1]],S:[[0,0,0],[0,1,1],[1,1,0]],T:[[0,0,0],[1,1,1],[0,1,0]],Z:[[0,0,0],[1,1,0],[0,1,1]]},j={};for(var X in S)j[X]=new R(S[X]);var Y=function(t){this._options=i({x:0,y:0,shape:w()},t),this.x=this._options.x,this.y=this._options.y,this.shape=this._options.shape},B={coordinate:{}};B.coordinate.get=function(){return{x:this.x,y:this.y,array:this.shape.shape}},Y.prototype.moveBy=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x+=t,this.y+=i},Y.prototype.moveTo=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i},Y.prototype.rotate=function(t){void 0===t&&(t=!0),this.shape.rotate(t)},Object.defineProperties(Y.prototype,B);var P=function(t){var e=this;this._options=i({matrix:new C,auto:!0,speed:500},t),this._events={},this._bind(),this.reset(),this.on("hit",function(){e.block.y+e.block.shape.margin.top<e.matrix.y?e.fail():e._next()})},T={graph:{}};T.graph.get=function(){var t=this.block,i=t.coordinate;return k(this.matrix.coordinate,i)},Object.defineProperties(P.prototype,T),function(t){var i=t.prototype;i.reset=function(){this.auto=this._options.auto,this.speed=this._options.speed,this.matrix=this._options.matrix,this.matrix.reset(),this._paused=!1,this._failed=!1,this.addBlock(),this.pause(),this.resume(),this.emit("repaint",this.graph)},i.pause=function(){this._paused=!0,this._timeout&&(clearTimeout(this._timeout),this._timeout=null)},i.resume=function(){this._paused=!1,this._timeout||this._process()},i.fail=function(){this._failed=!0,this._paused=!0,this.emit("repaint",this.graph),this.emit("failed")},i.start=i.reset,i._process=function(){var t=this,i=this,e=i.auto,n=i.speed;(function i(){e&&n&&!t._paused&&(t._timeout=setTimeout(function(){t.down(),i()},n))})()},i._next=function(){this._union(),this._clearLines(),this.addBlock()}}(P),function(t){var i=t.prototype;i.drop=function(){for(;this.down(););},i.down=function(){return!this._failed&&(this.save(),this.block.moveBy(0,1),this._detectCollision()?(this.restore(),this.emit("hit"),!1):(this.emit("repaint",this.graph),!0))},i.left=function(){return!this._failed&&(this.save(),this.block.moveBy(-1,0),this._detectCollision()?(this.restore(),this.emit("overflow:left"),!1):(this.emit("repaint",this.graph),!0))},i.right=function(){return!this._failed&&(this.save(),this.block.moveBy(1,0),this._detectCollision()?(this.restore(),this.emit("overflow:right"),!1):(this.emit("repaint",this.graph),!0))},i.rotate=function(){return!this._failed&&(this.save(),this.block.rotate(),this._detectCollision()?(this.restore(),this.emit("hit:rotate"),!1):(this.emit("repaint",this.graph),!0))},i.addBlock=function(t){if(this._failed)return!1;t||(t=new Y);var i=this.matrix,e=i.col,n=(i.row,t.shape),r=n.margin,o=Math.floor((e-r.col)/2)-r.left,s=0-r.row-r.top;t.moveTo(o,s),this.block=t}}(P),function(t){var i=t.prototype;i.on=function(t,i){this._events[t]||(this._events[t]=[]),this._events[t].push(i)},i.emit=function(t){for(var i=[],e=arguments.length-1;e-- >0;)i[e]=arguments[e+1];var n=this;(this._events[t]||[]).forEach(function(t){t.apply(n,i)})}}(P),function(t){var i=t.prototype;i.save=function(){this._lastState={matrix:{x:this.matrix.x,y:this.matrix.y,matrix:r(this.matrix.matrix)},block:{x:this.block.x,y:this.block.y,index:this.block.shape.index}}},i.restore=function(){var t=this._lastState,i=t.matrix,e=t.block;this.matrix.x=i.x,this.matrix.y=i.y,this.matrix.matrix=r(i.matrix),this.block.x=e.x,this.block.y=e.y,this.block.shape.index=e.index}}(P),function(t){t.prototype._bind=function(){var t=this;document.addEventListener("keydown",function(i){switch(i.which){case 32:t.down();break;case 37:t.left();break;case 38:t.rotate();break;case 39:t.right();break;case 40:t.down()}})}}(P),function(t){var i=t.prototype;i._union=function(){this.matrix.matrix=k(this.matrix.coordinate,this.block.coordinate).array},i._clearLines=function(){for(var t=this.matrix,i=t.matrix,e=i.length,n=[],r=[],o=e-1;o>=0;o--){for(var s=i[o],a=!0,h=!0,c=0,u=s.length;c<u&&(s[c]?a=!1:h=!1,a||h);c++);h?r.unshift(o):n.unshift(s)}return r.length&&this.emit("clear:lines",r),this.matrix.matrix=x(n,e),r}}(P),function(t){t.prototype._detectCollision=function(){var t=this,i=t.matrix,e=t.block,n=i.x,r=i.x+i.col,o=i.y+i.row,s=e.coordinate,a=s.x,h=s.y,c=e.shape,u=c.margin;return a+u.left<n||a+u.left+u.col>r||h+u.top+u.row>o||!!b(this.matrix.coordinate,this.block.coordinate)}}(P),t.Tetris=P,t.Shape=R,t.Block=Y,t.Matrix=C,t.default=P,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e(2);i.default={name:"tetris",data:function(){return{tetris:null,graph:Array(15).fill(Array(15)),_pasued:!1}},mounted:function(){this.init()},methods:{init:function(){var t=this;this.tetris=new n.Tetris({matrix:new n.Matrix({row:15,col:15})}),this.tetris.on("repaint",function(i){t.graph=i.array}),this.tetris.on("failed",function(){alert("Failed!")})},start:function(){this._pasued=!1,this.tetris.start()},pause:function(){this._pasued?(this._pasued=!1,this.tetris.resume()):(this._pasued=!0,this.tetris.pause())}}}},function(t,i,e){"use strict";var n=e(10),r=function(t){return t&&t.__esModule?t:{default:t}}(n);r.default.install({onUpdateReady:function(){console.log("update ready"),r.default.applyUpdate()},onUpdated:function(){console.log("updated"),location.reload()}})},,,function(t,i){},,,,function(t,i,e){e(7);var n=e(12)(e(3),e(13),null,null);t.exports=n.exports},,function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"game"},[e("ul",{staticClass:"row"},t._l(t.graph,function(i){return e("li",[e("ul",{staticClass:"col"},t._l(i,function(t){return e("li",{staticClass:"rect",class:{filled:t}},[e("div")])}))])}))]),t._v(" "),e("div",{staticClass:"controls"},[e("div",{staticClass:"left"},[e("div",{staticClass:"loop"},[e("div",{staticClass:"flex-center",on:{click:t.pause}},[e("a",{staticClass:"button"},[t._v("P")]),t._v(" "),e("span",[t._v("pause")])]),t._v(" "),e("div",{staticClass:"flex-center",on:{click:function(i){t.tetris.reset()}}},[e("a",{staticClass:"button"},[t._v("R")]),t._v(" "),e("span",[t._v("Reset")])])]),t._v(" "),e("div",{staticClass:"drop",on:{click:function(i){t.tetris.drop()}}},[e("a",{staticClass:"button"},[t._v("D")]),t._v(" "),e("span",[t._v("Drop(space)")])])]),t._v(" "),e("div",{staticClass:"right"},[e("div",[e("div",{staticClass:"flex-center",on:{click:function(i){t.tetris.rotate()}}},[e("a",{staticClass:"button"},[t._v("O")]),t._v(" "),e("span",[t._v("Rotate(up)")])])]),t._v(" "),e("div",{staticClass:"flex-space-around"},[e("div",{staticClass:"flex-center",on:{click:function(i){t.tetris.left()}}},[e("a",{staticClass:"button"},[t._v("L")]),t._v(" "),e("span",[t._v("Left(left)")])]),t._v(" "),e("div",{staticClass:"flex-center",on:{click:function(i){t.tetris.right()}}},[e("a",{staticClass:"button"},[t._v("R")]),t._v(" "),e("span",[t._v("Right(right)")])])]),t._v(" "),e("div",[e("div",{staticClass:"flex-center",on:{click:function(i){t.tetris.down()}}},[e("a",{staticClass:"button"},[t._v("D")]),t._v(" "),e("span",[t._v("Down(down)")])])])])]),t._v(" "),t._m(0)])},staticRenderFns:[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("p",[t._v("Powered by "),e("a",{attrs:{href:"//github.com/wasd-org/wasd-tetris"}},[t._v("wasd-tetris")])])}]}},,,function(t,i,e){t.exports=e(1)}],[16]);
//# sourceMappingURL=client.d6de0bf5.js.map